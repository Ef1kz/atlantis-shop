{% extends "admin/change_list.html" %}
{% load i18n admin_urls static admin_list %}

{% block extrahead %}
{{ block.super }}
<style>

        /* Делаем форму выхода строчной, чтобы она не перекрывала всё вокруг */
    #logout-form {
      display: inline !important;
      margin: 0 !important;
      padding: 0 !important;
    }

    /* Убираем "мертвые зоны" у контейнеров заголовка */
    #user-tools {
      pointer-events: none !important; /* Контейнер прозрачен для клика */
    }

    #user-tools a,
    #user-tools button,
    #user-tools form {
      pointer-events: auto !important; /* А сами элементы — кликабельны */
    }

    /* Увеличиваем область клика для мелких ссылок */
    #user-tools a {
      padding: 10px 5px !important;
      margin: -10px 0 !important;
    }

      /* 1. Делаем кнопки "кликабельными" поверх любых слоев */
    .header-controls, .user-info, .kanban-header {
      position: relative !important;
      z-index: 9999 !important; /* Поднимаем на самый верх */
      pointer-events: auto !important;
    }

/* 2. Убираем хлебные крошки, которые часто невидимым слоем перекрывают верх страницы */
.breadcrumbs {
  display: none !important;
}

/* 3. Если в твоей версии админки заголовок #header фиксированный,
    он может "наползать" прозрачным краем на кнопки */
#header {
  z-index: 100 !important;
}

/* 4. На всякий случай даем кнопкам область нажатия побольше (padding) */
.user-info a, .user-info button {
  display: inline-block;
  padding: 5px 2px;
  cursor: pointer;
}

/* Принудительно применяем стиль Atlantis к таблице товаров */
.content h1 { color: #f4a261 !important; }

#changelist {
  background: #121212 !important;
  border: 1px solid #2d2d2d !important;
  border-radius: 8px !important;
}

.results table thead th {
  background: #1a1a1a !important;
  border-bottom: 2px solid #f4a261 !important;
  color: #f4a261 !important;
}

.results table tbody tr { background: #161616 !important; border-bottom: 1px solid #2d2d2d !important; }
.results table tbody tr:hover { background: #1e1e1e !important; }

/* Кнопка "Добавить" */
.object-tools a.addlink {
  background-color: #2a9d8f !important;
  border-radius: 4px !important;
  padding: 8px 15px !important;
}
</style>
{% endblock %}

{% block content %}
{{ block.super }}

{# Исправление кнопок в стандартном меню пользователя через JS (для надежности в общем шаблоне) #}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const logoutLinks = document.querySelectorAll('a[href*="logout"]');
        logoutLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const form = document.createElement('form');
                form.method = 'POST';
                form.action = this.href;
                const csrf = document.createElement('input');
                csrf.type = 'hidden';
                csrf.name = 'csrfmiddlewaretoken';
                csrf.value = '{{ csrf_token }}';
                form.appendChild(csrf);
                document.body.appendChild(form);
                form.submit();
            });
        });
    });
</script>
{% endblock %}